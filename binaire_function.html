<script>

    function convertir_en_binaire(nombre) {
    
        const [entier_string, decimal_string] = nombre.toString().split('.');
        const binaire_entier = entier_en_binaire(parseInt(entier_string, 10));
        const binaire_decimale= decimal_en_binaire(decimal_string);
        return `${binaire_entier}.${binaire_decimale}`;
    }
    
    function decimal_en_binaire(decimal_string) {
        const puissances_negatives2 = [];
        for (let i = 1; i <= 64; i++) {
            puissances_negatives2.push(Math.pow(2, -i));
        }
    
        let partieDecimale = decimal_string ? parseFloat(`0.${decimal_string}`) : 0;
        let binaire_decimale = '';
    
        for (const puissance of puissances_negatives2) {
            if (partieDecimale >= puissance) {
                binaire_decimale += '1';
                partieDecimale -= puissance;
            } else {
                binaire_decimale += '0';
            }
        }
    
        return binaire_decimale;
    }
    
    function entier_en_binaire(n) {
        const puissancesDe2 = [];
    
        for (let i = 0; i < 63; i++) {
            puissancesDe2.push(Math.pow(2, i));
        }
        const binaire = [];
        for (let i = 62; i >= 0; i--) {
            if (n >= puissancesDe2[i]) {
                binaire.push(1);
                n -= puissancesDe2[i];
            } else {
                binaire.push(0);
            }
        }
        return binaire.join('');
    }

    function addition_binaire(x, y) {

/* separerr la partie decimale et la partie entiere de chaque nombre
faire une addition bit par bit de la partie decimal 
additionner les partie decimal d'un cote puis ajouter la retenue s'il y en a Ã  la somme */

let x_binaire = convertir_en_binaire(x);
const [x_entier, x_decimal] = x_binaire.split('.');
let y_binaire = convertir_en_binaire(y);
const [y_entier, y_decimal] = y_binaire.split('.');

let retenue = 0;
let resultat_entier = '';
let resultat_decimal = '';

for (let i = 1; i <= 64; i++) {
    let bit_x = i < x_decimal.length ? parseInt(x_decimal[i]) : 0;
    let bit_y = i < y_decimal.length ? parseInt(y_decimal[i]) : 0;

    let somme = bit_x + bit_y + retenue;
    if (somme === 2) {
        resultat_decimal = '0' + resultat_decimal;
        retenue = 1;
    } else if (somme === 3) {
        resultat_decimal = '1' + resultat_decimal;
        retenue = 1;
    } else {
        resultat_decimal = somme.toString() + resultat_decimal;
        retenue = 0;
    }
}

for (let i = 0; i < 63; i++) {
    let bit_x = i < x_entier.length ? parseInt(x_entier[i]) : 0;
    let bit_y = i < y_entier.length ? parseInt(y_entier[i]) : 0;

    let somme = bit_x + bit_y + retenue;
    if (somme === 2) {
        resultat_entier += '0';
        retenue = 1;
    } else if (somme === 3) {
        resultat_entier += '1';
        retenue = 1;
    } else {
        resultat_entier += somme.toString();
        retenue = 0;
    }
}

if (retenue === 1) {
    resultat_entier = '1' + resultat_entier;
}
return resultat_entier + '.' + resultat_decimal;
}
let resultat = addition_binaire(4.5, 8.7);
console.log(`L'addition binaire de ${4.5} et ${8.7} : ${resultat}`);


   /*const nombre = 14.123456789;
    const result1 = convertir_en_binaire(nombre);
    console.log(`Le nombre ${nombre} en binaire (64 bits decimaux) est : ${result1.binaire}`);
     console.log("Tableau des puissances negatives de 2 :", result1.puissances_negatives2);
    const grandNombre = 0.987654321;
    const result2 = convertir_en_binaire(grandNombre);
    console.log(`Le nombre ${grandNombre} en binaire (64 bits decimaux) est : ${result2.binaire}`);
    console.log("Tableau des puissances negatives de 2 :", result2.puissances_negatives2);*/
    
</script>