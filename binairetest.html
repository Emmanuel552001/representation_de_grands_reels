<script>
/*   
function convertirEnBinaire(n) {
    // Partie entere
    const partieEntiere = Math.floor(n);
    // Partie decimale
    let partieDecimale = n - partieEntiere;

    // Conversion de la partie entiere
    let binaireEntier = partieEntiere.toString(2);

    // Conversion de la partie decimale en utilisant la table des puissances de 2
    let pile = [];
    let binaireDecimale = '.';

    // On repete le processus jusqu'à ce que la partie décimale devienne 0
    while (partieDecimale > 0) {
        partieDecimale *= 2;
        if (partieDecimale >= 1) {
            pile.push(1); // On empile un 1 si la valeur est superieure ou égale à 1
            partieDecimale -= 1; // On soustrait 1 du résultat
        } else {
            pile.push(0); // On empile un 0 si la valeur est infrieure à 1
        }
        
        if (pile.length > 50) break; // verifier pour les grandes iterations pour voir ce que ca donne
    }

    // Ajout des bits de la partie décimale
    
    binaireDecimale += pile.join('');
    console.log(`decimal en binaire : ${binaireDecimale}`)

    return binaireEntier + binaireDecimale;
}

// Exemple d'utilisation
const nombre = 2.999999999999999;
console.log(`Le nombre ${nombre} en binaire est : ${convertirEnBinaire(nombre)}`);
/* limite actuelle : après 15 chiffres apres la virgule, javascript arrondit à la valeur supérieure nombre
 l'utilisation de Math.floor pour definit la partie entiere d'un reel negaritm arrondit à la valeur inferieur un nombre à virgule Math.floor(-5.05) = 6
 utiliser la library decimal.js pour voir ce que ca donne 


 Représentation en base flottante avec précision arbitraire
Représentation en séries infinies ou approximations contrôlées
Représentation en nombres de Cauchy ou formules continues
Utilisation de la représentation en "strings" pour des grands réels*/

// Générateur pour la partie décimale d'un nombre
function* convertirPartieDecimale(partieDecimale, maxIterations = 50) {
    let iteration = 0;
    while (partieDecimale > 0 && iteration < maxIterations) {
        partieDecimale *= 2;
        if (partieDecimale >= 1) {
            yield 1;
            partieDecimale -= 1;
        } else {
            yield 0;
        }
        iteration++;
    }
}
/*
// Fonction principale pour convertir un nombre réel en binaire
function convertirEnBinaireIteratif(nombre, maxIterations = 50) {
    const partieEntiere = Math.floor(nombre);
    let partieDecimale = nombre - partieEntiere;

    // Conversion de la partie entière
    const binaireEntier = partieEntiere.toString(2);

    // Conversion de la partie décimale en utilisant un itérateur
    const iterator = convertirPartieDecimale(partieDecimale, maxIterations);
    let binaireDecimale = '.';
    for (const bit of iterator) {
        binaireDecimale += bit;
    }

    return binaireEntier + binaireDecimale;
}

// Exemple d'utilisation
const nombre = 14.6875; // Exemple avec une partie décimale exacte
console.log(`Le nombre ${nombre} en binaire est : ${convertirEnBinaireIteratif(nombre)}`);

const grandNombre = 123456789.41867625725987654321; // Grand nombre réel
console.log(`Le grand nombre ${grandNombre} en binaire est : ${convertirEnBinaireIteratif(grandNombre)}`);*/

// Fonction pour convertir un nombre en chaîne (partie entière et décimale)
function convertirEnBinaireSansArrondi(nombre, maxIterations = 50) {
    // Séparer la partie entière et décimale en chaînes
    const [entierStr, decimalStr] = nombre.toString().split('.');

    // Partie entière : conversion classique
    const binaireEntier = parseInt(entierStr, 10).toString(2);

    // Partie décimale : conversion manuelle
    let partieDecimale = decimalStr ? `0.${decimalStr}` : '0';
    let binaireDecimale = '.';
    let iteration = 0;

    while (partieDecimale !== '0' && iteration < maxIterations) {
        // Multiplier par 2
        const multiplication = (parseFloat(partieDecimale) * 2).toString();
        const [entier, decimale] = multiplication.split('.');

        // Ajouter le bit au résultat
        binaireDecimale += entier;

        // Réinitialiser la partie décimale
        partieDecimale = decimale ? `0.${decimale}` : '0';
        iteration++;
    }

    return binaireEntier + binaireDecimale;
}

// Exemple d'utilisation
const grandNombre = "0.123456789014848499494234567890"; // Chaîne pour éviter toute perte de précision
console.log(`Le nombre ${grandNombre} en binaire est : ${convertirEnBinaireSansArrondi(grandNombre, 100)}`);

</script>